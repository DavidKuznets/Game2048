const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.board=t,this.score=0,this.status="idle",this.cells=document.querySelectorAll(".field-cell"),this.scoreElement=document.querySelector(".game-score"),this.messageLose=document.querySelector(".message-lose"),this.messageWin=document.querySelector(".message-win"),this.messageStart=document.querySelector(".message-start")}getState(){return this.board}getScore(){return this.score}getStatus(){return this.status}start(){this.status="playing",this.addRandomTile(),this.addRandomTile(),this.updateBoard(),this.hideMessages()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.start()}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(t.length>0){let{row:e,col:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}}moveLeft(){this.move(t=>t)}moveRight(){this.move(t=>t.reverse())}moveUp(){this.moveColumns(t=>t)}moveDown(){this.moveColumns(t=>t.reverse())}move(t){if("playing"!==this.status)return;let e=!1;for(let s=0;s<4;s++){let a=t([...this.board[s]]),i=this.compressRow(a),r=this.mergeRow(i),o=this.compressRow(r);a.toString()!==o.toString()&&(e=!0),this.board[s]=t([...o])}e&&(this.addRandomTile(),this.checkGameOver(),this.updateBoard())}moveColumns(t){this.transpose(),this.move(t),this.transpose(),this.updateBoard()}transpose(){let t=this.board[0];this.board=t.map((t,e)=>this.board.map(t=>t[e]))}compressRow(t){return t.filter(t=>0!==t).concat([,,,,].fill(0)).slice(0,4)}mergeRow(t){for(let e=0;e<3;e++)0!==t[e]&&t[e]===t[e+1]&&(t[e]*=2,t[e+1]=0,this.score+=t[e]);return t}checkGameOver(){if(!this.board.flat().includes(0)){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return;this.status="gameover",this.showMessage(this.messageLose)}}checkWin(){this.board.flat().includes(2048)&&(this.status="win",this.showMessage(this.messageWin))}updateBoard(){let t=0;for(let e=0;e<4;e++)for(let s=0;s<4;s++)this.cells[t].textContent=0!==this.board[e][s]?this.board[e][s]:"",this.cells[t].className=`field-cell field-cell--${this.board[e][s]}`,t++;this.scoreElement.textContent=this.score,this.checkWin()}showMessage(t){this.messageLose.classList.add("hidden"),this.messageWin.classList.add("hidden"),this.messageStart.classList.add("hidden"),t.classList.remove("hidden")}hideMessages(){this.messageLose.classList.add("hidden"),this.messageWin.classList.add("hidden"),this.messageStart.classList.add("hidden")}},e=document.querySelector(".button.start");function s(){"idle"===t.getStatus()?(e.textContent="Start",e.classList.remove("restart"),e.classList.add("start")):(e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart"))}e.addEventListener("click",()=>{"idle"===t.getStatus()?t.start():t.restart(),s()}),s(),document.addEventListener("keydown",e=>{if("playing"===t.getStatus())switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}});
//# sourceMappingURL=index.8c5dd4dc.js.map
